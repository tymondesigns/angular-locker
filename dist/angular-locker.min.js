/*! angular-locker v0.6.3 | (c) 2014 @tymondesigns | https://github.com/tymondesigns/angular-locker */
!function(e,t){"use strict";t.module("angular-locker",[]).config(function(e){e.decorator("$exceptionHandler",["$log","$delegate",function(e,t){return function(r,i){e.debug("[angular-locker] - "+r.message),t(r,i)}}])}).provider("locker",function(){var e=function(e){return t.isFunction(e)?e():e},r=function(e,t){return Object.keys(e).filter(function(r){return e[r]===t})[0]},i={driver:"local",namespace:"locker"};return{setDefaultDriver:function(t){return i.driver=e(t),this},getDefaultDriver:function(){return i.driver},setDefaultNamespace:function(t){return i.namespace=e(t),this},getDefaultNamespace:function(){return i.namespace},$get:["$window","$rootScope","$parse",function(n,s,o){function a(i,o){this._registeredDrivers={local:n.localStorage,session:n.sessionStorage},this._resolveDriver=function(e){if(!this._registeredDrivers.hasOwnProperty(e))throw new Error('The driver "'+e+'" was not found. Defaulting to local.');return this._registeredDrivers[e]||this._registeredDrivers.local},this._deriveDriver=function(e){return r(this._registeredDrivers,e)},this._driver=this._resolveDriver(i),this._namespace=o,this._checkSupport=function(e){if("undefined"==typeof this._supported){var t="l";try{this._resolveDriver(e||"local").setItem(t,t),this._resolveDriver(e||"local").removeItem(t),this._supported=!0}catch(r){this._supported=!1}}return this._supported},this._separator=".",this._watchers={},this._getPrefix=function(e){return this._namespace+this._separator+e},this._serialize=function(e){try{return t.toJson(e)}catch(r){return e}},this._unserialize=function(e){try{return t.fromJson(e)}catch(r){return e}},this._event=function(e,r){var i=t.extend(r,{driver:this._deriveDriver(this._driver),namespace:this._namespace});s.$emit(e,i)},this._setItem=function(e,r){try{var i=this._getItem(e);this._driver.setItem(this._getPrefix(e),this._serialize(r)),this._exists(e)&&!t.equals(i,r)?this._event("locker.item.updated",{key:e,oldValue:i,newValue:r}):this._event("locker.item.added",{key:e,value:r})}catch(n){throw new Error(-1!==["QUOTA_EXCEEDED_ERR","NS_ERROR_DOM_QUOTA_REACHED","QuotaExceededError"].indexOf(n.name)?"Your browser storage quota has been exceeded":'Could not add item with key "'+e+'"')}},this._getItem=function(e){return this._unserialize(this._driver.getItem(this._getPrefix(e)))},this._exists=function(t){return this._driver.hasOwnProperty(this._getPrefix(e(t)))},this._removeItem=function(e){return this._exists(e)?(this._driver.removeItem(this._getPrefix(e)),this._event("locker.item.forgotten",{key:e}),!0):!1}}a.prototype={put:function(r,i){if(!r)return!1;if(r=e(r),t.isObject(r))t.forEach(r,function(e,t){this._setItem(t,e)},this);else{if(!t.isDefined(i))return!1;this._setItem(r,e(i))}return this},add:function(e,t){return this.has(e)?!1:(this.put(e,t),!0)},get:function(e,r){if(t.isArray(e)){var i={};return t.forEach(e,function(e){this.has(e)&&(i[e]=this._getItem(e))},this),i}return this.has(e)?this._getItem(e):2===arguments.length?r:void 0},has:function(e){return this._exists(e)},forget:function(r){return r=e(r),t.isArray(r)?t.forEach(r,function(e){this._removeItem(e)},this):this._removeItem(r),this},pull:function(e,t){var r=this.get(e,t);return this.forget(e),r},all:function(){var e={};return t.forEach(this._driver,function(t,r){var i=r.split(this._separator);i.length>1&&i[0]===this._namespace&&(i.splice(0,1),r=i.join(this._separator)),this.has(r)&&(e[r]=this.get(r))},this),e},clean:function(){return this.forget(Object.keys(this.all())),this},empty:function(){return this._driver.clear(),this},count:function(){return Object.keys(this.all()).length},bind:function(e,r,i){t.isUndefined(e.$eval(r))&&o(r).assign(e,this.get(r,i));var n=this;this._watchers[r+e.$id]=e.$watch(r,function(e){t.isDefined(e)&&n.put(r,e)},t.isObject(e[r]))},unbind:function(e,t){o(t).assign(e,null),this.forget(t),this._watchers[t+e]&&delete this._watchers[t+e]},driver:function(e){return new a(e,this._namespace)},getDriver:function(){return this._driver},namespace:function(e){return new a(this._deriveDriver(this._driver),e)},getNamespace:function(){return this._namespace},supported:function(e){return this._checkSupport(e)}};var u={local:new a("local",i.namespace),session:new a("session",i.namespace)};return u[i.driver]}]}})}(window,window.angular);
//# sourceMappingURL=angular-locker.min.js.map